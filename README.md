# こんだてLoop

レシピを集めてレシピセットで献立（手札）を回し、買い物リストを自動生成するローカルツールです。ブラウザで `index.html` を開いて使います。

## セットアップ

### 必須
- モダンブラウザ（Chrome, Firefox, Safari, Edge）

### AI機能を使う場合（任意）
URLやテキストからレシピを自動解析する機能を使うには、ローカルLLM（Ollama）のセットアップが必要です。

1. **Ollamaをインストール**
   ```bash
   # macOS
   brew install ollama

   # または公式サイトからダウンロード
   # https://ollama.ai/download
   ```

2. **モデルをダウンロード**
   ```bash
   ollama pull gemma2:2b
   ```

3. **CORS対応で起動**
   ```bash
   OLLAMA_ORIGINS="*" ollama serve
   ```

   > 注意: Ollamaが既に起動している場合は一度停止してから上記コマンドで再起動してください

4. **動作確認**
   ```bash
   curl http://localhost:11434/api/tags
   ```
   モデル一覧が返ってくればOKです。

## 起動方法

1. `index.html` をブラウザで開く
2. 献立（手札）ページがデフォルトで開きます（複数品を追加可能）
3. レシピの追加は「レシピ帳」から行う
4. レシピセットは「レシピカタログ」から選択し、必要なら「セットを作る」で自作する

## 機能

### 献立（手札）
- セットを選ぶと献立プールが生成される
- 横スクロールカードで手札を表示
- 「作った」で進捗を記録（グレーアウトで残す）
- 次の献立/セットの切り替えが可能

### レシピセット
- 1週間の雰囲気をセットで選ぶ（順序は固定しない）
- セットを献立に反映
- セット作成画面でレシピ帳のレシピから自作
- 1〜7品でセット作成、既存セットから編集可能

### レシピ帳/レシピカタログ
- レシピ名、URL、食材、作り方メモを登録
- 食材は「名前 / 数量 / 単位」形式（例: 玉ねぎ 1 個、鶏肉 200 g）
- URLからの自動取得（JSON-LD対応サイト or Ollama解析）
- テキスト貼り付けからの解析（Twitter/Xのレシピなど）
- レシピ/セットのタブ切り替え + 検索/カテゴリ
- 公開側は購入/メンバーシップの状態を表示

### 買い物リスト/冷蔵庫
- 献立から買い物リストを自動生成
- 同じ食材 + 同じ単位は合算
- 冷蔵庫在庫との差分を反映
- 買い物チェックを冷蔵庫に反映

### 料理家/メンバーシップ/通知
- 料理家詳細（ホーム/レシピ/セット/メンバーシップ）
- 複数プランのメンバーシップ加入フロー
- 掲示板/限定コンテンツ
- 通知（ニュース/あなた宛て）

### マイページ/履歴
- 購入履歴/決済履歴/加入中メンバーシップ
- アーカイブ（料理ログ）/診断

## データ保存

- 入力内容はブラウザのローカルストレージに保存
- サーバー不要、オフラインでも動作

## スコープ外（このプロトでは未実装）
- 決済の実連携/外部同期（ログイン・クラウド保存）
- レシート読み取り/賞味期限管理
- 画像アップロード/アイコン選択の本実装

## 技術スタック

- HTML / CSS / JavaScript（バニラ）
- ローカルストレージ
- Ollama（オプション、ローカルLLM）

## UI更新メモ

### 2026-01-25
- レシピ詳細に「中間素材」セクションを追加（材料と手順の間）
- レシピ追加画面に中間素材入力を追加（任意、A/Bラベル対応）
- 買い物リストのチェック状態を保持（画面を閉じても維持）
- 買い物リスト生成時に冷蔵庫在庫を差分反映（不足分のみ）
- 献立カードは未調理→調理済みの順に並び替え
- 買い物リスト導線をモーダルに統一（ガイド内ボタン含む）
- 全ヘッダーに「使い方」導線と冷蔵庫ショートカットを表示
- マイページのプランセクションを削除（プロフィールのプラン表示に統合）
- 購入直後にレシピ帳への保存を促すモーダルを追加（保存時のみレシピ帳へ反映）

### 2026-01-26
- 通知（ニュース/あなた宛て）とバッジを追加
- 料理家詳細/メンバーシップの導線を追加
- マイページに購入/決済/加入/アーカイブ/診断を集約
