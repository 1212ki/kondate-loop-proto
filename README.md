# Kondate Loop

レシピを集めてレシピセットで献立（手札）を回し、買い物リストを自動生成するローカルツールです。ブラウザで `index.html` を開いて使います。

## セットアップ

### 必須
- モダンブラウザ（Chrome, Firefox, Safari, Edge）

### AI機能を使う場合（任意）
URLやテキストからレシピを自動解析する機能を使うには、ローカルLLM（Ollama）のセットアップが必要です。

1. **Ollamaをインストール**
   ```bash
   # macOS
   brew install ollama

   # または公式サイトからダウンロード
   # https://ollama.ai/download
   ```

2. **モデルをダウンロード**
   ```bash
   ollama pull gemma2:2b
   ```

3. **CORS対応で起動**
   ```bash
   OLLAMA_ORIGINS="*" ollama serve
   ```

   > 注意: Ollamaが既に起動している場合は一度停止してから上記コマンドで再起動してください

4. **動作確認**
   ```bash
   curl http://localhost:11434/api/tags
   ```
   モデル一覧が返ってくればOKです。

## 起動方法

1. `index.html` をブラウザで開く
2. 献立（手札）ページがデフォルトで開きます（複数品を追加可能）
3. レシピの追加は献立の入力 or 「レシピ帳」から行う
4. レシピセットは「レシピカタログ」から選択し、必要なら「セットを作る」で自作する

## 機能

### 献立（手札）
- 週単位の保存を前提にしつつ、UIは「今の手札」として扱う
- 1日に複数の品目を追加可能
- 料理名を入力すると候補が表示される
- 「作った」で進捗を記録（グレーアウトで残す）

### レシピセット
- 1週間の雰囲気をセットで選ぶ（順序は固定しない）
- セットを献立に反映
- セット作成画面でレシピ帳のレシピから自作

### レシピ帳/レシピカタログ
- レシピ名、URL、食材、作り方メモを登録
- 食材は「名前 / 数量 / 単位」形式（例: 玉ねぎ 1 個、鶏肉 200 g）
- URLからの自動取得（JSON-LD対応サイト or Ollama解析）
- テキスト貼り付けからの解析（Twitter/Xのレシピなど）
- タグ付け機能（出典、ジャンルなど）

### 食材リスト
- 選択したレシピの食材を人数に合わせて自動集計
- 同じ食材 + 同じ単位は合算
- 単位が異なる場合は別行で表示
- チェックボックスで買い物管理

## データ保存

- 入力内容はブラウザのローカルストレージに保存
- 週ごとに保存されるため、週を切り替えると過去の記録が復元
- サーバー不要、オフラインでも動作

## スコープ外（このプロトでは未実装）
- メンバーシップ/課金/料理家詳細/通知ベル/掲示板

## 技術スタック

- HTML / CSS / JavaScript（バニラ）
- ローカルストレージ
- Ollama（オプション、ローカルLLM）

## UI更新メモ

### 2026-01-25
- レシピ詳細に「中間素材」セクションを追加（材料と手順の間）
- レシピ追加画面に中間素材入力を追加（任意、A/Bラベル対応）
- 買い物リストのチェック状態を保持（画面を閉じても維持）
- 買い物リスト生成時に冷蔵庫在庫を差分反映（不足分のみ）
- 献立カードは未調理→調理済みの順に並び替え
- 買い物リスト導線をモーダルに統一（ガイド内ボタン含む）
- 全ヘッダーに「使い方」導線と冷蔵庫ショートカットを表示
- マイページのプランセクションを削除（プロフィールのプラン表示に統合）
- 購入直後にレシピ帳への保存を促すモーダルを追加（保存時のみレシピ帳へ反映）
